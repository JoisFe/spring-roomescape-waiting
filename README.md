# spring-roomesacpe-waiting

## 1단계 - 인증 로직 리팩터링

1. [x] auth 패키지를 nextstep 패키지로부터 분리한다
   1. [x] auth 패키지에서 nextstep로 의존하는 부분을 제거한다.
   2. [x] auth 패키지 내에서 스프링 빈으로 사용되던 객체를 Component Scan이 아닌 Java Configuration으로 빈 등록한다.

<br>

## 2단계 - 예약 대기

### 기능 요구사항

1. [x] 이미 예약이 된 스케줄 대상으로 예약 대기를 신청할 수 있다.
   1. [x] 예약이 없는 스케줄에 대해서 예약 대기 신청을 할 경우 예약이 된다.
2. [x] 자신의 예약 대기를 취소할 수 있다.
   1. [x] 자신의 예약 대기가 아닌경우 취소할 수 없다.
3. [x] 나의 예약 목록을 조회할 수 있다.
   1. [x] 예약과 예약 대기를 나눠서 조회한다.
   2. [x] 예약은 reservation을 조회하고 예약 대기는 reservation-waiting을 조회한다.
   3. [x] 예약 대기의 경우 대기 순번도 함께 조회할 수 있다.
   4. [x] 취소된 예약도 조회할 수 있다.

<br>

## 3단계 - 예약 승인

### 기능 요구사항

1. [x] 예약 승인
   1. [x] 예약 사용자가 예약금을 입금을 하면 예약 승인을 한다
   2. [x] 이 때 예약금이 매출로 기록된다.
   3. [x] 예약의 상태가 입금 대기에서 예약 승인 상태로 변경된다.
2. [x] 사용자 예약 취소
   1. [x] 사용자가 예약을 취소하는 경우 예약 미승인(입금 대기) 상태와 승인 상태로 구분이 된다.
   2. [x] 예약 미승(입금 대기)인 상태면 예약의 상태가 예약 철회로 변경된다
   3. [x] 예약이 승인된 상태라면 관리자의 승인이 필요하다
      1. [x] 관리자가 예약 취소를 승인하면 예약 취소가 진행된다
      2. [x] 매출에 환불이 기록된다
      3. [x] 예약의 상태가 예약 철회로 변경된다.
      4. [x] 예약 대기자가 있는 경우 예약자로 변경할 수 있다.
3. [x] 관리자 예약 취소
   1. [x] 관리자도 예약을 취소할 수 있는데 이 역시 예약 미승인(입금 대기) 상태와 승인 상태로 구분이 된다.
   2. [x] 예약 미승인(입금 대기) 상태면 예약의 상태가 예약 취소로 변경된다
   3. [x] 예약 승인 상태면 별도의 승인 절차 없이 예약이 취소된다
      1. [x] 사용자 예약 취소와 같은 프로세스를 진행한다.

<br>

## 프로그래밍 요구사항

1. [x] 트랜잭션을 설정하고 적절한 옵션을 이용한다.

<br>
